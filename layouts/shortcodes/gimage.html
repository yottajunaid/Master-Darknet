{{ $id := .Get 0 }}
{{ $imgData := index .Site.Data.images $id }}

{{ if $imgData }}
  {{/* Initialize variables */}}
  {{ $finalLink := "" }}
  {{ $rawLink := $imgData.link }}

  {{/* LOGIC: Check where the link comes from */}}
  
  {{ if in $rawLink "drive.google.com" }}
    {{/* CASE A: It is a Google Drive Link (JPEG/PNG) -> Apply Magic Link Logic */}}
    {{ $fileID := replace $rawLink "https://drive.google.com/uc?export=view&id=" "" }}
    {{ $finalLink = printf "https://lh3.googleusercontent.com/d/%s" $fileID }}
  
  {{ else }}
    {{/* CASE B: It is a GitHub/External Link (SVG) -> Use exactly as is */}}
    {{ $finalLink = $rawLink }}
  {{ end }}

  <figure>
    <img src="{{ $finalLink }}" 
         alt="{{ $imgData.caption }}" 
         loading="lazy"
         style="max-width: 100%; height: auto;"
         referrerpolicy="no-referrer">
         
    {{ with $imgData.caption }}<figcaption>{{ . }}</figcaption>{{ end }}
  </figure>

{{ else }}
  <p style="color:red; font-weight:bold;">Error: Image ID {{ $id }} not found.</p>
{{ end }}
